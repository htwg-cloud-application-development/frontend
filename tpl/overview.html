<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" [routerLink]="['/']">
                <span class="glyphicon glyphicon-cloud" aria-hidden="true"></span>
                <span class="app-name">Cloud-App</span>
            </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li><a [routerLink]="['/']">Home</a></li>
                <li><a  [routerLink]="['/about']">About</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a [routerLink]="['/import']">Import</a></li>
            </ul>
            <form class="navbar-form navbar-right" role="search">
                <div class="form-group">
                    <input type="text" class="form-control js-course-filter" placeholder="Search" autofocus [(ngModel)]="filterCourse" #inputCourseFilter>
                </div>
            </form>
        </div>
    </div>
</nav>

<div class="container">

    <div class="page-header">
        <h1>Overview</h1>
    </div>

    <div class="panel-group" id="accordion-courses" role="tablist" aria-multiselectable="true">
        <div *ngFor="let course of courses | courseFilter:filterCourse" class="panel panel-primary">
            <div class="panel-heading" role="tab">
                <h4 class="panel-title">
                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse-{{course.id}}" aria-expanded="false">
                        {{course.shortname}} - {{course.fullname}}
                    </a>
                    <template [ngIf]="course.groups != null">
                        <span class="pull-right">{{course.groups.length}} Groups</span>
                    </template>
                </h4>
            </div>
            <div id="collapse-{{course.id}}" class="panel-collapse collapse" role="tabpanel">
                <div class="panel-body">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                        <tr>
                            <th class="text-center" rowspan="2">Group</th>
                            <th class="text-center" rowspan="2">Validate</th>
                            <th class="text-center" colspan="3">Checkstyle</th>
                            <th class="text-center" colspan="3">PMD</th>
                        </tr>
                        <tr>
                            <th class="text-center">Errors</th>
                            <th class="text-center">Warnings</th>
                            <th class="text-center">Duration</th>
                            <th class="text-center">Errors</th>
                            <th class="text-center">Warnings</th>
                            <th class="text-center">Duration</th>
                        </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let group of course.groups">
                                <th>
                                    <template [ngIf]="group.pmd != null || group.checkstyle != null">
                                        <a href="#" (click)="onGroupClick($event, group)">{{group.repository}}</a>
                                    </template>
                                    <template [ngIf]="group.pmd == null && group.checkstyle == null">
                                        {{group.repository}}
                                    </template>
                                </th>
                                <td class="text-center">
                                    <a href="#" (click)="onValidateGroup($event, course, group)" *ngIf="groupValidation[group.userId] == null">
                                        <span class="glyphicon glyphicon-play text-success" aria-hidden="true"></span>
                                    </a>

                                    <span *ngIf="groupValidation[group.userId] == true" class="glyphicon glyphicon-refresh gly-spin text-info" aria-hidden="true"></span>
                                </td>

                                <template [ngIf]="group.checkstyle != null">
                                    <td class="text-right">{{group.checkstyle.numberOfErrors}}</td>
                                    <td class="text-right">{{group.checkstyle.numberOfWarnings}}</td>
                                    <td class="text-right">{{group.checkstyle.totalExpendedTime / 1000 | number:'1.0-0'}} ms</td>
                                </template>
                                <template [ngIf]="group.checkstyle == null">
                                    <td class="text-right">-</td>
                                    <td class="text-right">-</td>
                                    <td class="text-right">-</td>
                                </template>

                                <template [ngIf]="group.pmd != null">
                                    <td class="text-right">{{group.pmd.numberOfErrors}}</td>
                                    <td class="text-right">{{group.pmd.numberOfWarnings}}</td>
                                    <td class="text-right">{{group.pmd.totalExpendedTime / 1000 | number:'1.0-0'}} ms</td>
                                </template>
                                <template [ngIf]="group.pmd == null">
                                    <td class="text-right">-</td>
                                    <td class="text-right">-</td>
                                    <td class="text-right">-</td>
                                </template>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>